<!DOCTYPE html>

<html th:lang-xmllang="#{lang}" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:insert="fragments/head.html"></th:block>
    <title th:text="|Admin Â· #{title}|"></title>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" th:href="@{/}"><img th:src="@{/assets/img/LogoW.svg}" alt="AStA Logo"
                    width="30"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link"
                            th:classappend="not ${#strings.contains(#httpServletRequest.requestURI, '/admin/')} ? 'active'"
                            th:href="@{/admin}" th:text="#{nav.admin}"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            th:classappend="${#strings.contains(#httpServletRequest.requestURI, '/users')} ? 'active'"
                            th:href="@{/admin/users}" th:text="#{nav.users}"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            th:classappend="${#strings.contains(#httpServletRequest.requestURI, '/gremien')} ? 'active'"
                            th:href="@{/admin/gremien}" th:text="#{nav.gremien}"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link"
                            th:classappend="${#strings.contains(#httpServletRequest.requestURI, '/queries')} ? 'active'"
                            th:href="@{/admin/queries}" th:text="#{nav.queries}"></a>
                    </li>
                    <li class="nav-item d-md-none d-block">
                        <a class="nav-link" th:href=@{/logout} th:text="#{logout}"></a>
                    </li>
                </ul>
            </div>
            <div class="d-lg-flex d-none">
                <button class="btn btn-light btn-sm me-md-2" th:text="#{edit.gremium}" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasGremium" aria-controls="offcanvasGremium"></button>
                <a class=" btn btn-outline-light btn-sm" th:href=@{/logout} th:text="#{logout}"></a>
            </div>
        </div>
    </nav>
    <!-- Main Content -->
    <main>
        <div class="container-fluid pt-5 px-3">
            <!-- Title -->
            <div class="row pt-4">
                <div class="col-12 text-center">
                    <h1 th:text="${gremium.name}"></h1>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-12 col-lg-8 text-center">
                    <span th:text="${gremium.description}"></span>
                </div>
            </div>
        </div>
        <div class="container my-4">
            <!-- Queries Heading -->
            <div th:if="${gremium.containedQueries.size() > 0}" class="row justify-content-center mt-4">
                <div class="col-12 text-center">
                    <h3 th:text="#{nav.queries}"></h3>
                    <p class="form-text" th:text="#{admin.help.queries}"></p>
                </div>
            </div>
            <!-- Queries -->
            <div class="row justify-content-center">
                <div class="col-12 col-md-6">
                    <div class="list-group">
                        <a class="list-group-item bg-light list-group-item-action text-decoration-none link-dark"
                            th:each="q, status : ${gremium.containedQueries}" th:href="@{/admin/queries/__${q.id}__}">
                            <span th:text="|${status.count}. |"></span><span th:text="${q.text}"></span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <!-- Candidate Heading -->
            <div th:if="${gremium.joinedCandidates.size() > 0}" class="row justify-content-center">
                <div class="col-12 text-center">
                    <h3 th:text="#{info.candidates}"></h3>
                    <p class="form-text" th:text="#{admin.help.users}"></p>
                </div>
            </div>
            <!-- Candidate List -->
            <th:block th:each="c : ${gremium.joinedCandidates}">
                <div class="row justify-content-center mb-2">
                    <div class="col-lg-5 col-12">
                        <a class="text-decoration-none text-black"
                            th:href="@{/admin/users/__${c.id}__}">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-12 col-lg-2 text-center text-lg-start">
                                            <img class="thumbnail-profile-img"
                                                th:src="${c.getPhoto() != null} ? @{/api/v1/photo/__${c.id}__} : @{/assets/img/placeholder.jpg}"
                                                alt="Profile picture" />
                                        </div>
                                        <div class="col-12 col-lg-10 text-center text-lg-start">
                                            <p class="pt-2">
                                                <span class="card-text text-"
                                                    th:text="${c.age le 0} ? |${c.firstname} ${c.lastname}| : |${c.firstname} ${c.lastname}, ${c.age}|"></span><br />
                                                <span class="text-secondary"
                                                    th:text="${c.semester le 0 || c.course eq ''} ? #{candidate.student} : |${c.semester}. Semester, ${c.course}|"></span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </th:block>
        </div>
    </main>
    <!-- Gremium Offcanvas -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasGremium" aria-labelledby="GremiumCanvasLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="GremiumCanvasLabel" th:text="#{edit.gremium}"></h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <form class="row g-2" th:method="POST" th:action="@{/admin/gremien/__${gremium.abbr}__}"
                th:object="${form}">
                <div class="mb-3 col-12">
                    <label for="name" th:text="#{gremium.name}"></label>
                    <input th:field="*{name}" th:placeholder="#{placeholder.gremium.name}" type="text"
                        class="form-control" id="name" required>
                </div>
                <div class="mb-3 col-12">
                    <label for="abbr" th:text="#{gremium.abbr}"></label>
                    <input th:field="*{abbr}" type="text" class="form-control" id="abbr" required>
                </div>
                <div class="mb-3 col-12">
                    <label for="description" th:text="#{description}"></label>
                    <textarea th:field="*{description}" class="form-control" id="description" style="min-height: 15rem;"
                        required></textarea>
                </div>
                <div class="d-grid gap-3">
                    <button class="btn btn-dark" type="submit" th:text="#{edit.save}"></button>
                </div>
                <div class="d-grid gap-3">
                    <a class="btn btn-danger text-light" th:text="#{gremium.delete}"
                        th:href="@{/admin/gremien/__${gremium.abbr}__/delete}"
                        onclick="return confirm('Are you sure you want to delete this Gremium with all its queries and candidates?');"></a>
                </div>
            </form>
        </div>
    </div>
    <th:block th:insert="fragments/footer.html"></th:block>
    <th:block th:insert="fragments/scripts.html"></th:block>
</body>

</html>